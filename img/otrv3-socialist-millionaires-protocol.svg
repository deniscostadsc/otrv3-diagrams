<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="1380" height="1164" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[title: OTRv3 - Socialist Millionaires' Protocol (SMP)

Note right of Alice: 1. Picks random exponents a2 and a3
Alice->Bob: 2. Sends Bob g2a = g1^a2 and g3a = g1^a3

Note right of Bob: 1. Picks random exponents b2 and b3
Note right of Bob: 2. Computes g2b = g1^b2 and g3b = g1^b3
Note right of Bob: 3. Computes g2 = g2a^b2 and g3 = g3a^b3
Note right of Bob: 4. Picks random exponent r
Note right of Bob: 5. Computes Pb = g3^r and Qb = g1^r g2^y
Bob->Alice: 6. Sends Alice g2b, g3b, Pb and Qb

Note right of Alice: 1. Computes g2 = g2b^a2 and g3 = g3b^a3
Note right of Alice: 2. Picks random exponent s
Note right of Alice: 3. Computes Pa = g3^s and Qa = g1^s g2^x
Note right of Alice: 4. Computes Ra = (Qa / Qb) a3
Alice->Bob: 5. Sends Bob Pa, Qa and Ra

Note right of Bob: 1. Computes Rb = (Qa / Qb)^b3
Note right of Bob: 2. Computes Rab = Ra^b3
Note right of Bob: 3. Checks whether Rab == (Pa / Pb)
Bob->Alice: 4. Sends Alice Rb

Note right of Alice: 1. Computes Rab = Rb^a3
Note right of Alice: 2. Checks whether Rab == (Pa / Pb)

Note over Alice, Bob: If everything is done correctly, then Rab should hold the value of (Pa / Pb) times \n (g2^a3b3)^(x - y), which means that the test at the end of the protocol will only \n succeed if x == y. Further, since g2^a3b3 is a random number not known to any party, \n if x is not equal to y, no other information is revealed.]]></source><desc>OTRv3 - Socialist Millionaires' Protocol (SMP)</desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"><rect x="10" y="10" width="470" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="15" y="30" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="15">OTRv3 - Socialist Millionaires' Protocol (SMP)</tspan></text></g><g class="actor"><rect x="10" y="49" width="70" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="74" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="20">Alice</tspan></text></g><g class="actor"><rect x="10" y="1105.6000061035156" width="70" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="1130.6000061035156" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="20">Alice</tspan></text></g><line x1="45" x2="45" y1="88" y2="1105.6000061035156" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="actor"><rect x="850" y="49" width="50" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="860" y="74" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="860">Bob</tspan></text></g><g class="actor"><rect x="850" y="1105.6000061035156" width="50" height="39" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="860" y="1130.6000061035156" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="860">Bob</tspan></text></g><line x1="875" x2="875" y1="88" y2="1105.6000061035156" style="stroke-width: 2;" stroke="#000000" fill="none"></line><g class="note"><rect x="65" y="108" width="360" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="70" y="128" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="70">1. Picks random exponents a2 and a3</tspan></text></g><g class="signal"><text x="260" y="167.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="260">2. Sends Bob g2a = g1^a2 and g3a = g1^a3</tspan></text><line x1="45" x2="875" y1="176" y2="176" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="895" y="196" width="360" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="900" y="216" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="900">1. Picks random exponents b2 and b3</tspan></text></g><g class="note"><rect x="895" y="245" width="400" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="900" y="265" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="900">2. Computes g2b = g1^b2 and g3b = g1^b3</tspan></text></g><g class="note"><rect x="895" y="294" width="400" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="900" y="314" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="900">3. Computes g2 = g2a^b2 and g3 = g3a^b3</tspan></text></g><g class="note"><rect x="895" y="343" width="270" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="900" y="363" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="900">4. Picks random exponent r</tspan></text></g><g class="note"><rect x="895" y="392" width="410" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="900" y="412" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="900">5. Computes Pb = g3^r and Qb = g1^r g2^y</tspan></text></g><g class="signal"><text x="290" y="451.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="290">6. Sends Alice g2b, g3b, Pb and Qb</tspan></text><line x1="875" x2="45" y1="460" y2="460" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="65" y="480" width="400" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="70" y="500" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="70">1. Computes g2 = g2b^a2 and g3 = g3b^a3</tspan></text></g><g class="note"><rect x="65" y="529" width="270" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="70" y="549" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="70">2. Picks random exponent s</tspan></text></g><g class="note"><rect x="65" y="578" width="410" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="70" y="598" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="70">3. Computes Pa = g3^s and Qa = g1^s g2^x</tspan></text></g><g class="note"><rect x="65" y="627" width="300" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="70" y="647" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="70">4. Computes Ra = (Qa / Qb) a3</tspan></text></g><g class="signal"><text x="330" y="686.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="330">5. Sends Bob Pa, Qa and Ra</tspan></text><line x1="45" x2="875" y1="695" y2="695" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="895" y="715" width="300" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="900" y="735" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="900">1. Computes Rb = (Qa / Qb)^b3</tspan></text></g><g class="note"><rect x="895" y="764" width="240" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="900" y="784" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="900">2. Computes Rab = Ra^b3</tspan></text></g><g class="note"><rect x="895" y="813" width="350" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="900" y="833" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="900">3. Checks whether Rab == (Pa / Pb)</tspan></text></g><g class="signal"><text x="375" y="872.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="375">4. Sends Alice Rb</tspan></text><line x1="875" x2="45" y1="881" y2="881" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="note"><rect x="65" y="901" width="240" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="70" y="921" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="70">1. Computes Rab = Rb^a3</tspan></text></g><g class="note"><rect x="65" y="950" width="350" height="29" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="70" y="970" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="70">2. Checks whether Rab == (Pa / Pb)</tspan></text></g><g class="note"><rect x="35" y="999" width="850" height="86.60000610351562" style="stroke-width: 2;" stroke="#000000" fill="#ffffff"></rect><text x="40" y="1019" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="40">If everything is done correctly, then Rab should hold the value of (Pa / Pb) times</tspan><tspan dy="1.2em" x="40">(g2^a3b3)^(x - y), which means that the test at the end of the protocol will only</tspan><tspan dy="1.2em" x="40">succeed if x == y. Further, since g2^a3b3 is a random number not known to any party,</tspan><tspan dy="1.2em" x="40">if x is not equal to y, no other information is revealed.</tspan></text></g></svg>